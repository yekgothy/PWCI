<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Post - World Cup Hub</title>
    <script src="https://cdn.tailwindcss.com?v=3.4.1"></script>
</head>
<body class="bg-neutral-50 text-neutral-900 font-sans min-h-screen" style="background-image: url('../public/bgFeed.png'); background-size: cover; background-position: center; background-attachment: fixed;">

    <!-- NAVBAR COMPONENT -->
    <div id="navbar"></div>

    <!-- MAIN CONTENT -->
    <main class="min-h-screen pt-16 md:pt-0">
        <div class="flex max-w-7xl mx-auto">
            
            <!-- LEFT SIDEBAR -->
            <div class="w-72 fixed left-0 top-0 h-screen overflow-y-auto hidden md:block" id="sidebarFeed1"></div>
            
            <!-- CENTER CONTENT -->
            <div class="flex-1 md:ml-72 md:mr-72 px-6 py-8">
                <div class="max-w-2xl mx-auto">
                    
                    <!-- Header -->
                    <div class="mb-8">
                        <h1 class="text-3xl font-bold text-neutral-900 mb-2">Crear Nueva Publicación</h1>
                        <p class="text-neutral-600">Comparte tu pasión por el fútbol con la comunidad</p>
                    </div>

                    <!-- Create Post Form -->
                    <div class="bg-white rounded-xl shadow-lg border border-neutral-200 p-6">
                        <form id="createPostForm" class="space-y-6">

                            <!-- Post Title -->
                            <div>
                                <label for="title" class="block text-sm font-medium text-neutral-700 mb-2">
                                    Título de la publicación *
                                </label>
                                <input 
                                    type="text" 
                                    id="title" 
                                    name="title" 
                                    class="w-full px-4 py-3 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" 
                                    placeholder="¿Qué quieres compartir sobre el Mundial?"
                                    required
                                    minlength="5"
                                    maxlength="200"
                                >
                                <p class="text-xs text-neutral-500 mt-1">Mínimo 5 caracteres</p>
                            </div>

                            <!-- Category Selection -->
                            <div>
                                <label for="category" class="block text-sm font-medium text-neutral-700 mb-2">
                                    Categoría *
                                </label>
                                <select 
                                    id="category" 
                                    name="category" 
                                    class="w-full px-4 py-3 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" 
                                    required
                                >
                                    <option value="">Cargando categorías...</option>
                                </select>
                            </div>

                            <!-- World Cup Selection -->
                            <div>
                                <label for="mundial" class="block text-sm font-medium text-neutral-700 mb-2">
                                    Mundial *
                                </label>
                                <select 
                                    id="mundial" 
                                    name="mundial" 
                                    class="w-full px-4 py-3 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" 
                                    required
                                >
                                    <option value="">Cargando mundiales...</option>
                                </select>
                            </div>

                            <!-- Post Content -->
                            <div>
                                <label for="content" class="block text-sm font-medium text-neutral-700 mb-2">
                                    Contenido *
                                </label>
                                <textarea 
                                    id="content" 
                                    name="content" 
                                    rows="8" 
                                    class="w-full px-4 py-3 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none transition-all" 
                                    placeholder="Escribe tu publicación aquí... Comparte tu análisis, opinión o noticia sobre el Mundial."
                                    required
                                    minlength="20"
                                    maxlength="2000"
                                ></textarea>
                                <p id="charCounter" class="text-xs text-neutral-500 mt-1">2000 caracteres restantes</p>
                            </div>

                            <!-- Image Upload (BLOB) -->
                            <div>
                                <label for="imageFile" class="block text-sm font-medium text-neutral-700 mb-2">
                                    Subir imagen (opcional)
                                </label>
                                <div class="flex items-center justify-center w-full">
                                    <label for="imageFile" class="flex flex-col items-center justify-center w-full h-32 border-2 border-neutral-300 border-dashed rounded-lg cursor-pointer bg-neutral-50 hover:bg-neutral-100 transition-all">
                                        <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                            <svg class="w-8 h-8 mb-3 text-neutral-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                                            </svg>
                                            <p class="mb-2 text-sm text-neutral-600"><span class="font-semibold">Click para subir</span> o arrastra aquí</p>
                                            <p class="text-xs text-neutral-500">PNG, JPG, GIF o WebP (MAX. 5MB)</p>
                                        </div>
                                        <input 
                                            id="imageFile" 
                                            name="imageFile"
                                            type="file" 
                                            class="hidden" 
                                            accept="image/jpeg,image/png,image/gif,image/webp"
                                        />
                                    </label>
                                </div>
                                
                                <!-- Image Preview -->
                                <div id="imagePreview" class="mt-4 hidden">
                                    <div class="relative rounded-lg overflow-hidden border border-neutral-200">
                                        <img id="previewImage" src="" alt="Preview" class="w-full h-64 object-cover">
                                        <button 
                                            type="button" 
                                            id="removeImage"
                                            class="absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition-colors shadow-lg"
                                        >
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                            </svg>
                                        </button>
                                    </div>
                                    <p id="imageInfo" class="text-xs text-neutral-500 mt-2"></p>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex gap-4 pt-4 border-t border-neutral-200">
                                <a 
                                    href="feed.html" 
                                    class="flex-1 px-6 py-3 border-2 border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-all text-center font-medium"
                                >
                                    Cancelar
                                </a>
                                <button 
                                    type="submit" 
                                    id="submitBtn"
                                    class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all text-center font-medium shadow-sm hover:shadow-md"
                                >
                                    Publicar
                                </button>
                            </div>

                        </form>
                    </div>

                </div>
            </div>
            
            <!-- RIGHT SIDEBAR -->
            <div class="w-72 fixed right-0 top-0 h-screen overflow-y-auto hidden lg:block" id="sidebarFeed2"></div>

        </div>
    </main>

    <!-- Scripts -->
    <script src="../controllers/createPost.js"></script>
    <script src="../controllers/sidebar.js"></script>
    <script>
        // Load components
        Promise.all([
            fetch('../components/navbar.html').then(response => response.text()),
            fetch('../components/sidebarFeed1.html').then(response => response.text()),
            fetch('../components/sidebarFeed2.html').then(response => response.text())
        ]).then(([navbarHTML, sidebar1HTML, sidebar2HTML]) => {
            document.getElementById('navbar').innerHTML = navbarHTML;
            document.getElementById('sidebarFeed1').innerHTML = sidebar1HTML;
            document.getElementById('sidebarFeed2').innerHTML = sidebar2HTML;
            
            // Initialize sidebar user info AFTER components are loaded
            if (typeof initSidebar === 'function') {
                initSidebar();
            }
            
            // Update active menu item for this page
            updateActiveMenuItem();
            
            // Initialize navbar functionality
            initializeNavbar();
            initCountdown();
        });

        function updateActiveMenuItem() {
            // Remove active class from all menu items
            const menuItems = document.querySelectorAll('#sidebarFeed1 nav ul li a');
            menuItems.forEach(item => {
                item.classList.remove('bg-zinc-800', 'text-white', 'font-semibold');
                item.classList.add('text-zinc-400');
            });
            
            // Add active class to "Crear Post"
            const createPostLink = Array.from(menuItems).find(item => 
                item.getAttribute('href') === '../pages/createPost.html'
            );
            if (createPostLink) {
                createPostLink.classList.remove('text-zinc-400');
                createPostLink.classList.add('bg-zinc-800', 'text-white', 'font-semibold');
            }
        }

        function initializeNavbar() {
            const menuButton = document.getElementById('menuButton');
            const sidebarMenu = document.getElementById('sidebarMenu');
            const closeMenuButton = document.getElementById('closeMenuButton');
            const menuOverlay = document.getElementById('menuOverlay');

            if (menuButton && sidebarMenu) {
                menuButton.addEventListener('click', () => {
                    sidebarMenu.classList.remove('hidden');
                });

                if (closeMenuButton) {
                    closeMenuButton.addEventListener('click', () => {
                        sidebarMenu.classList.add('hidden');
                    });
                }

                if (menuOverlay) {
                    menuOverlay.addEventListener('click', () => {
                        sidebarMenu.classList.add('hidden');
                    });
                }
            }
        }

        function initCountdown() {
            const targetDate = new Date('2026-06-11T00:00:00Z').getTime();

            function updateCountdown() {
                const now = new Date().getTime();
                const distance = targetDate - now;

                if (distance > 0) {
                    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                    const daysElement = document.getElementById('days');
                    const hoursElement = document.getElementById('hours');
                    const minutesElement = document.getElementById('minutes');
                    const secondsElement = document.getElementById('seconds');

                    if (daysElement) daysElement.textContent = days;
                    if (hoursElement) hoursElement.textContent = hours;
                    if (minutesElement) minutesElement.textContent = minutes;
                    if (secondsElement) secondsElement.textContent = seconds;
                }
            }

            updateCountdown();
            setInterval(updateCountdown, 1000);
        }
    </script>

</body>
</html>
